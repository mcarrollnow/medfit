Code execution tool - Claude Docs 

[Claude Docs home page![light logo](../../../../../mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/light%EF%B9%96fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=c877c45432515ee69194cb19e9f983a2.svg)![dark logo](../../../../../mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/dark%EF%B9%96fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=f5bb877be0cb3cba86cf6d7c88185216.svg)](../../../home.html)

![US](../../../../../d3gk2c5xim1je2.cloudfront.net/flags/US.svg)

English

Search...

⌘K

-   [Console](https://console.anthropic.com/login)
-   [Support](https://support.claude.com/)
-   [Discord](https://www.anthropic.com/discord)
-   [Sign up](https://console.anthropic.com/login)
-   [
    
    Sign up
    
    ](https://console.anthropic.com/login)

Search...

Navigation

Tools

Code execution tool

[Welcome

](../../../home.html)[Claude Developer Platform

](../../intro.html)[Claude Code

](../../claude-code/overview.html)[Model Context Protocol (MCP)

](../../mcp.html)[API Reference

](../../../api/messages.html)[Resources

](../../../resources/overview.html)[Release Notes

](../../../release-notes/overview.html)

-   [
    
    Developer Guide](../../intro.html)
-   [
    
    API Guide](../../../api/overview.html)

##### First steps

-   [
    
    Intro to Claude
    
    
    
    ](../../intro.html)
-   [
    
    Quick start
    
    
    
    ](../../get-started.html)

##### Models & pricing

-   [
    
    Models overview
    
    
    
    ](../../about-claude/models/overview.html)
-   [
    
    Choosing a model
    
    
    
    ](../../about-claude/models/choosing-a-model.html)
-   [
    
    What's new in Claude 4.5
    
    
    
    ](../../about-claude/models/whats-new-claude-4-5.html)
-   [
    
    Migrating to Claude 4.5
    
    
    
    ](../../about-claude/models/migrating-to-claude-4.html)
-   [
    
    Model deprecations
    
    
    
    ](../../about-claude/model-deprecations.html)
-   [
    
    Pricing
    
    
    
    ](../../about-claude/pricing.html)

##### Learn about Claude

-   [
    
    Features overview
    
    
    
    ](../../build-with-claude/overview.html)
-   [
    
    Building with Claude
    
    
    
    ](../../overview.html)
-   [
    
    Context windows
    
    
    
    ](../../build-with-claude/context-windows.html)
-   [
    
    Glossary
    
    
    
    ](../../about-claude/glossary.html)

##### Capabilities

-   [
    
    Prompt caching
    
    
    
    ](../../build-with-claude/prompt-caching.html)
-   [
    
    Context editing
    
    
    
    ](../../build-with-claude/context-editing.html)
-   [
    
    Extended thinking
    
    
    
    ](../../build-with-claude/extended-thinking.html)
-   [
    
    Streaming Messages
    
    
    
    ](../../build-with-claude/streaming.html)
-   [
    
    Batch processing
    
    
    
    ](../../build-with-claude/batch-processing.html)
-   [
    
    Citations
    
    
    
    ](../../build-with-claude/citations.html)
-   [
    
    Multilingual support
    
    
    
    ](../../build-with-claude/multilingual-support.html)
-   [
    
    Token counting
    
    
    
    ](../../build-with-claude/token-counting.html)
-   [
    
    Embeddings
    
    
    
    ](../../build-with-claude/embeddings.html)
-   [
    
    Vision
    
    
    
    ](../../build-with-claude/vision.html)
-   [
    
    PDF support
    
    
    
    ](../../build-with-claude/pdf-support.html)
-   [
    
    Files API
    
    
    
    ](../../build-with-claude/files.html)
-   [
    
    Search results
    
    
    
    ](../../build-with-claude/search-results.html)
-   [
    
    Google Sheets add-on
    
    
    
    ](../claude-for-sheets.html)

##### Tools

-   [
    
    Overview
    
    
    
    ](overview.html)
-   [
    
    How to implement tool use
    
    
    
    ](implement-tool-use.html)
-   [
    
    Token-efficient tool use
    
    
    
    ](token-efficient-tool-use.html)
-   [
    
    Fine-grained tool streaming
    
    
    
    ](fine-grained-tool-streaming.html)
-   [
    
    Bash tool
    
    
    
    ](bash-tool.html)
-   [
    
    Code execution tool
    
    
    
    ](code-execution-tool.html)
-   [
    
    Computer use tool
    
    
    
    ](computer-use-tool.html)
-   [
    
    Text editor tool
    
    
    
    ](text-editor-tool.html)
-   [
    
    Web fetch tool
    
    
    
    ](web-fetch-tool.html)
-   [
    
    Web search tool
    
    
    
    ](web-search-tool.html)
-   [
    
    Memory tool
    
    
    
    ](memory-tool.html)

##### Agent Skills

-   [
    
    Overview
    
    
    
    ](../agent-skills/overview.html)
-   [
    
    Quickstart
    
    
    
    ](../agent-skills/quickstart.html)
-   [
    
    Best practices
    
    
    
    ](../agent-skills/best-practices.html)

##### Model Context Protocol (MCP)

-   [
    
    MCP connector
    
    
    
    ](../mcp-connector.html)
-   [
    
    Remote MCP servers
    
    
    
    ](../remote-mcp-servers.html)

##### Use cases

-   [
    
    Overview
    
    
    
    ](../../about-claude/use-case-guides/overview.html)
-   [
    
    Ticket routing
    
    
    
    ](../../about-claude/use-case-guides/ticket-routing.html)
-   [
    
    Customer support agent
    
    
    
    ](../../about-claude/use-case-guides/customer-support-chat.html)
-   [
    
    Content moderation
    
    
    
    ](../../about-claude/use-case-guides/content-moderation.html)
-   [
    
    Legal summarization
    
    
    
    ](../../about-claude/use-case-guides/legal-summarization.html)

##### Prompt engineering

-   [
    
    Overview
    
    
    
    ](../../build-with-claude/prompt-engineering/overview.html)
-   [
    
    Claude 4 best practices
    
    
    
    ](../../build-with-claude/prompt-engineering/claude-4-best-practices.html)
-   [
    
    Prompt generator
    
    
    
    ](../../build-with-claude/prompt-engineering/prompt-generator.html)
-   [
    
    Use prompt templates
    
    
    
    ](../../build-with-claude/prompt-engineering/prompt-templates-and-variables.html)
-   [
    
    Prompt improver
    
    
    
    ](../../build-with-claude/prompt-engineering/prompt-improver.html)
-   [
    
    Be clear and direct
    
    
    
    ](../../build-with-claude/prompt-engineering/be-clear-and-direct.html)
-   [
    
    Use examples (multishot prompting)
    
    
    
    ](../../build-with-claude/prompt-engineering/multishot-prompting.html)
-   [
    
    Let Claude think (CoT)
    
    
    
    ](../../build-with-claude/prompt-engineering/chain-of-thought.html)
-   [
    
    Use XML tags
    
    
    
    ](../../build-with-claude/prompt-engineering/use-xml-tags.html)
-   [
    
    Give Claude a role (system prompts)
    
    
    
    ](../../build-with-claude/prompt-engineering/system-prompts.html)
-   [
    
    Prefill Claude's response
    
    
    
    ](../../build-with-claude/prompt-engineering/prefill-claudes-response.html)
-   [
    
    Chain complex prompts
    
    
    
    ](../../build-with-claude/prompt-engineering/chain-prompts.html)
-   [
    
    Long context tips
    
    
    
    ](../../build-with-claude/prompt-engineering/long-context-tips.html)
-   [
    
    Extended thinking tips
    
    
    
    ](../../build-with-claude/prompt-engineering/extended-thinking-tips.html)

##### Test & evaluate

-   [
    
    Define success criteria
    
    
    
    ](../../test-and-evaluate/define-success.html)
-   [
    
    Develop test cases
    
    
    
    ](../../test-and-evaluate/develop-tests.html)
-   [
    
    Using the Evaluation Tool
    
    
    
    ](../../test-and-evaluate/eval-tool.html)
-   [
    
    Reducing latency
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/reduce-latency.html)

##### Strengthen guardrails

-   [
    
    Reduce hallucinations
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/reduce-hallucinations.html)
-   [
    
    Increase output consistency
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/increase-consistency.html)
-   [
    
    Mitigate jailbreaks
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks.html)
-   [
    
    Streaming refusals
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/handle-streaming-refusals.html)
-   [
    
    Reduce prompt leak
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/reduce-prompt-leak.html)
-   [
    
    Keep Claude in character
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/keep-claude-in-character.html)

 

On this page

-   [Model compatibility](#model-compatibility)
-   [Quick start](#quick-start)
-   [How code execution works](#how-code-execution-works)
-   [How to use the tool](#how-to-use-the-tool)
-   [Execute Bash commands](#execute-bash-commands)
-   [Create and edit files directly](#create-and-edit-files-directly)
-   [Upload and analyze your own files](#upload-and-analyze-your-own-files)
-   [Upload and analyze files](#upload-and-analyze-files)
-   [Retrieve generated files](#retrieve-generated-files)
-   [Combine operations](#combine-operations)
-   [Tool definition](#tool-definition)
-   [Response format](#response-format)
-   [Bash command response](#bash-command-response)
-   [File operation responses](#file-operation-responses)
-   [Results](#results)
-   [Errors](#errors)
-   [pause\_turn stop reason](#pause-turn-stop-reason)
-   [Containers](#containers)
-   [Runtime environment](#runtime-environment)
-   [Resource limits](#resource-limits)
-   [Networking and security](#networking-and-security)
-   [Pre-installed libraries](#pre-installed-libraries)
-   [Container reuse](#container-reuse)
-   [Example](#example)
-   [Streaming](#streaming)
-   [Batch requests](#batch-requests)
-   [Usage and pricing](#usage-and-pricing)
-   [Upgrade to latest tool version](#upgrade-to-latest-tool-version)
-   [What’s changed](#what%E2%80%99s-changed)
-   [Backward compatibility](#backward-compatibility)
-   [Upgrade steps](#upgrade-steps)
-   [Using code execution with Agent Skills](#using-code-execution-with-agent-skills)

Tools

# Code execution tool

Copy page

Copy page

Claude can analyze data, create visualizations, perform complex calculations, run system commands, create and edit files, and process uploaded files directly within the API conversation. The code execution tool allows Claude to run Bash commands and manipulate files, including writing code, in a secure, sandboxed environment.

The code execution tool is currently in public beta.To use this feature, add the `"code-execution-2025-08-25"` [beta header](../../../api/beta-headers.html) to your API requests.

## 

[​

](#model-compatibility)

Model compatibility

The code execution tool is available on the following models:

| Model | Tool Version |
| --- | --- |
| Claude Opus 4.1 (`claude-opus-4-1-20250805`) | `code_execution_20250825` |
| Claude Opus 4 (`claude-opus-4-20250514`) | `code_execution_20250825` |
| Claude Sonnet 4.5 (`claude-sonnet-4-5-20250929`) | `code_execution_20250825` |
| Claude Sonnet 4 (`claude-sonnet-4-20250514`) | `code_execution_20250825` |
| Claude Sonnet 3.7 (`claude-3-7-sonnet-20250219`) | `code_execution_20250825` |
| Claude Haiku 4.5 (`claude-haiku-4-5-20251001`) | `code_execution_20250825` |
| Claude Haiku 3.5 (`claude-3-5-haiku-latest`) | `code_execution_20250825` |

The current version `code_execution_20250825` supports Bash commands and file operations. A legacy version `code_execution_20250522` (Python only) is also available. See [Upgrade to latest tool version](#upgrade-to-latest-tool-version) for migration details.

Older tool versions are not guaranteed to be backwards-compatible with newer models. Always use the tool version that corresponds to your model version.

## 

[​

](#quick-start)

Quick start

Here’s a simple example that asks Claude to perform a calculation:

Shell

Python

TypeScript

Copy

```shellscript
curl https://api.anthropic.com/v1/messages \
    --header "x-api-key: $ANTHROPIC_API_KEY" \
    --header "anthropic-version: 2023-06-01" \
    --header "anthropic-beta: code-execution-2025-08-25" \
    --header "content-type: application/json" \
    --data '{
        "model": "claude-sonnet-4-5",
        "max_tokens": 4096,
        "messages": [
            {
                "role": "user",
                "content": "Calculate the mean and standard deviation of [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]"
            }
        ],
        "tools": [{
            "type": "code_execution_20250825",
            "name": "code_execution"
        }]
    }'
```

## 

[​

](#how-code-execution-works)

How code execution works

When you add the code execution tool to your API request:

1.  Claude evaluates whether code execution would help answer your question
2.  The tool automatically provides Claude with the following capabilities:
    -   **Bash commands**: Execute shell commands for system operations and package management
    -   **File operations**: Create, view, and edit files directly, including writing code
3.  Claude can use any combination of these capabilities in a single request
4.  All operations run in a secure sandbox environment
5.  Claude provides results with any generated charts, calculations, or analysis

## 

[​

](#how-to-use-the-tool)

How to use the tool

### 

[​

](#execute-bash-commands)

Execute Bash commands

Ask Claude to check system information and install packages:

Shell

Python

TypeScript

Copy

```shellscript
curl https://api.anthropic.com/v1/messages \
    --header "x-api-key: $ANTHROPIC_API_KEY" \
    --header "anthropic-version: 2023-06-01" \
    --header "anthropic-beta: code-execution-2025-08-25" \
    --header "content-type: application/json" \
    --data '{
        "model": "claude-sonnet-4-5",
        "max_tokens": 4096,
        "messages": [{
            "role": "user",
            "content": "Check the Python version and list installed packages"
        }],
        "tools": [{
            "type": "code_execution_20250825",
            "name": "code_execution"
        }]
    }'
```

### 

[​

](#create-and-edit-files-directly)

Create and edit files directly

Claude can create, view, and edit files directly in the sandbox using the file manipulation capabilities:

Shell

Python

TypeScript

Copy

```shellscript
curl https://api.anthropic.com/v1/messages \
    --header "x-api-key: $ANTHROPIC_API_KEY" \
    --header "anthropic-version: 2023-06-01" \
    --header "anthropic-beta: code-execution-2025-08-25" \
    --header "content-type: application/json" \
    --data '{
        "model": "claude-sonnet-4-5",
        "max_tokens": 4096,
        "messages": [{
            "role": "user",
            "content": "Create a config.yaml file with database settings, then update the port from 5432 to 3306"
        }],
        "tools": [{
            "type": "code_execution_20250825",
            "name": "code_execution"
        }]
    }'
```

### 

[​

](#upload-and-analyze-your-own-files)

Upload and analyze your own files

To analyze your own data files (CSV, Excel, images, etc.), upload them via the Files API and reference them in your request:

Using the Files API with Code Execution requires two beta headers: `"anthropic-beta": "code-execution-2025-08-25,files-api-2025-04-14"`

The Python environment can process various file types uploaded via the Files API, including:

-   CSV
-   Excel (.xlsx, .xls)
-   JSON
-   XML
-   Images (JPEG, PNG, GIF, WebP)
-   Text files (.txt, .md, .py, etc)

#### 

[​

](#upload-and-analyze-files)

Upload and analyze files

1.  **Upload your file** using the [Files API](../../build-with-claude/files.html)
2.  **Reference the file** in your message using a `container_upload` content block
3.  **Include the code execution tool** in your API request

Shell

Python

TypeScript

Copy

```shellscript
# First, upload a file
curl https://api.anthropic.com/v1/files \
    --header "x-api-key: $ANTHROPIC_API_KEY" \
    --header "anthropic-version: 2023-06-01" \
    --header "anthropic-beta: files-api-2025-04-14" \
    --form 'file=@"data.csv"' \

# Then use the file_id with code execution
curl https://api.anthropic.com/v1/messages \
    --header "x-api-key: $ANTHROPIC_API_KEY" \
    --header "anthropic-version: 2023-06-01" \
    --header "anthropic-beta: code-execution-2025-08-25,files-api-2025-04-14" \
    --header "content-type: application/json" \
    --data '{
        "model": "claude-sonnet-4-5",
        "max_tokens": 4096,
        "messages": [{
            "role": "user",
            "content": [
                {"type": "text", "text": "Analyze this CSV data"},
                {"type": "container_upload", "file_id": "file_abc123"}
            ]
        }],
        "tools": [{
            "type": "code_execution_20250825",
            "name": "code_execution"
        }]
    }'
```

#### 

[​

](#retrieve-generated-files)

Retrieve generated files

When Claude creates files during code execution, you can retrieve these files using the Files API:

Python

TypeScript

Copy

```python
from anthropic import Anthropic

# Initialize the client
client = Anthropic()

# Request code execution that creates files
response = client.beta.messages.create(
    model="claude-sonnet-4-5",
    betas=["code-execution-2025-08-25", "files-api-2025-04-14"],
    max_tokens=4096,
    messages=[{
        "role": "user",
        "content": "Create a matplotlib visualization and save it as output.png"
    }],
    tools=[{
        "type": "code_execution_20250825",
        "name": "code_execution"
    }]
)

# Extract file IDs from the response
def extract_file_ids(response):
    file_ids = []
    for item in response.content:
        if item.type == 'bash_code_execution_tool_result':
            content_item = item.content
            if content_item.type == 'bash_code_execution_result':
                for file in content_item.content:
                    if hasattr(file, 'file_id'):
                        file_ids.append(file.file_id)
    return file_ids

# Download the created files
for file_id in extract_file_ids(response):
    file_metadata = client.beta.files.retrieve_metadata(file_id)
    file_content = client.beta.files.download(file_id)
    file_content.write_to_file(file_metadata.filename)
    print(f"Downloaded: {file_metadata.filename}")
```

### 

[​

](#combine-operations)

Combine operations

A complex workflow using all capabilities:

Shell

Python

TypeScript

Copy

```shellscript
# First, upload a file
curl https://api.anthropic.com/v1/files \
    --header "x-api-key: $ANTHROPIC_API_KEY" \
    --header "anthropic-version: 2023-06-01" \
    --header "anthropic-beta: files-api-2025-04-14" \
    --form 'file=@"data.csv"' \
    > file_response.json

# Extract file_id (using jq)
FILE_ID=$(jq -r '.id' file_response.json)

# Then use it with code execution
curl https://api.anthropic.com/v1/messages \
    --header "x-api-key: $ANTHROPIC_API_KEY" \
    --header "anthropic-version: 2023-06-01" \
    --header "anthropic-beta: code-execution-2025-08-25,files-api-2025-04-14" \
    --header "content-type: application/json" \
    --data '{
        "model": "claude-sonnet-4-5",
        "max_tokens": 4096,
        "messages": [{
            "role": "user",
            "content": [
                {
                    "type": "text", 
                    "text": "Analyze this CSV data: create a summary report, save visualizations, and create a README with the findings"
                },
                {
                    "type": "container_upload", 
                    "file_id": "'$FILE_ID'"
                }
            ]
        }],
        "tools": [{
            "type": "code_execution_20250825",
            "name": "code_execution"
        }]
    }'
```

## 

[​

](#tool-definition)

Tool definition

The code execution tool requires no additional parameters:

JSON

Copy

```json
{
  "type": "code_execution_20250825",
  "name": "code_execution"
}
```

When this tool is provided, Claude automatically gains access to two sub-tools:

-   `bash_code_execution`: Run shell commands
-   `text_editor_code_execution`: View, create, and edit files, including writing code

## 

[​

](#response-format)

Response format

The code execution tool can return two types of results depending on the operation:

### 

[​

](#bash-command-response)

Bash command response

Copy

```json
{
  "type": "server_tool_use",
  "id": "srvtoolu_01B3C4D5E6F7G8H9I0J1K2L3",
  "name": "bash_code_execution",
  "input": {
    "command": "ls -la | head -5"
  }
},
{
  "type": "bash_code_execution_tool_result",
  "tool_use_id": "srvtoolu_01B3C4D5E6F7G8H9I0J1K2L3",
  "content": {
    "type": "bash_code_execution_result",
    "stdout": "total 24\ndrwxr-xr-x 2 user user 4096 Jan 1 12:00 .\ndrwxr-xr-x 3 user user 4096 Jan 1 11:00 ..\n-rw-r--r-- 1 user user  220 Jan 1 12:00 data.csv\n-rw-r--r-- 1 user user  180 Jan 1 12:00 config.json",
    "stderr": "",
    "return_code": 0
  }
}
```

### 

[​

](#file-operation-responses)

File operation responses

**View file:**

Copy

```json
{
  "type": "server_tool_use",
  "id": "srvtoolu_01C4D5E6F7G8H9I0J1K2L3M4",
  "name": "text_editor_code_execution",
  "input": {
    "command": "view",
    "path": "config.json"
  }
},
{
  "type": "text_editor_code_execution_tool_result",
  "tool_use_id": "srvtoolu_01C4D5E6F7G8H9I0J1K2L3M4",
  "content": {
    "type": "text_editor_code_execution_result",
    "file_type": "text",
    "content": "{\n  \"setting\": \"value\",\n  \"debug\": true\n}",
    "numLines": 4,
    "startLine": 1,
    "totalLines": 4
  }
}
```

**Create file:**

Copy

```json
{
  "type": "server_tool_use",
  "id": "srvtoolu_01D5E6F7G8H9I0J1K2L3M4N5",
  "name": "text_editor_code_execution",
  "input": {
    "command": "create",
    "path": "new_file.txt",
    "file_text": "Hello, World!"
  }
},
{
  "type": "text_editor_code_execution_tool_result",
  "tool_use_id": "srvtoolu_01D5E6F7G8H9I0J1K2L3M4N5",
  "content": {
    "type": "text_editor_code_execution_result",
    "is_file_update": false
  }
}
```

**Edit file (str\_replace):**

Copy

```json
{
  "type": "server_tool_use",
  "id": "srvtoolu_01E6F7G8H9I0J1K2L3M4N5O6",
  "name": "text_editor_code_execution",
  "input": {
    "command": "str_replace",
    "path": "config.json",
    "old_str": "\"debug\": true",
    "new_str": "\"debug\": false"
  }
},
{
  "type": "text_editor_code_execution_tool_result",
  "tool_use_id": "srvtoolu_01E6F7G8H9I0J1K2L3M4N5O6",
  "content": {
    "type": "text_editor_code_execution_result",
    "oldStart": 3,
    "oldLines": 1,
    "newStart": 3,
    "newLines": 1,
    "lines": ["-  \"debug\": true", "+  \"debug\": false"]
  }
}
```

### 

[​

](#results)

Results

All execution results include:

-   `stdout`: Output from successful execution
-   `stderr`: Error messages if execution fails
-   `return_code`: 0 for success, non-zero for failure

Additional fields for file operations:

-   **View**: `file_type`, `content`, `numLines`, `startLine`, `totalLines`
-   **Create**: `is_file_update` (whether file already existed)
-   **Edit**: `oldStart`, `oldLines`, `newStart`, `newLines`, `lines` (diff format)

### 

[​

](#errors)

Errors

Each tool type can return specific errors: **Common errors (all tools):**

Copy

```json
{
  "type": "bash_code_execution_tool_result",
  "tool_use_id": "srvtoolu_01VfmxgZ46TiHbmXgy928hQR",
  "content": {
    "type": "bash_code_execution_tool_result_error",
    "error_code": "unavailable"
  }
}
```

**Error codes by tool type:**

| Tool | Error Code | Description |
| --- | --- | --- |
| All tools | `unavailable` | The tool is temporarily unavailable |
| All tools | `execution_time_exceeded` | Execution exceeded maximum time limit |
| All tools | `container_expired` | Container expired and is no longer available |
| All tools | `invalid_tool_input` | Invalid parameters provided to the tool |
| All tools | `too_many_requests` | Rate limit exceeded for tool usage |
| text\_editor | `file_not_found` | File doesn’t exist (for view/edit operations) |
| text\_editor | `string_not_found` | The `old_str` not found in file (for str\_replace) |

#### 

[​

](#pause-turn-stop-reason)

`pause_turn` stop reason

The response may include a `pause_turn` stop reason, which indicates that the API paused a long-running turn. You may provide the response back as-is in a subsequent request to let Claude continue its turn, or modify the content if you wish to interrupt the conversation.

## 

[​

](#containers)

Containers

The code execution tool runs in a secure, containerized environment designed specifically for code execution, with a higher focus on Python.

### 

[​

](#runtime-environment)

Runtime environment

-   **Python version**: 3.11.12
-   **Operating system**: Linux-based container
-   **Architecture**: x86\_64 (AMD64)

### 

[​

](#resource-limits)

Resource limits

-   **Memory**: 5GiB RAM
-   **Disk space**: 5GiB workspace storage
-   **CPU**: 1 CPU

### 

[​

](#networking-and-security)

Networking and security

-   **Internet access**: Completely disabled for security
-   **External connections**: No outbound network requests permitted
-   **Sandbox isolation**: Full isolation from host system and other containers
-   **File access**: Limited to workspace directory only
-   **Workspace scoping**: Like [Files](../../build-with-claude/files.html), containers are scoped to the workspace of the API key
-   **Expiration**: Containers expire 30 days after creation

### 

[​

](#pre-installed-libraries)

Pre-installed libraries

The sandboxed Python environment includes these commonly used libraries:

-   **Data Science**: pandas, numpy, scipy, scikit-learn, statsmodels
-   **Visualization**: matplotlib, seaborn
-   **File Processing**: pyarrow, openpyxl, xlsxwriter, xlrd, pillow, python-pptx, python-docx, pypdf, pdfplumber, pypdfium2, pdf2image, pdfkit, tabula-py, reportlab\[pycairo\], Img2pdf
-   **Math & Computing**: sympy, mpmath
-   **Utilities**: tqdm, python-dateutil, pytz, joblib, unzip, unrar, 7zip, bc, rg (ripgrep), fd, sqlite

## 

[​

](#container-reuse)

Container reuse

You can reuse an existing container across multiple API requests by providing the container ID from a previous response. This allows you to maintain created files between requests.

### 

[​

](#example)

Example

Python

TypeScript

Shell

Copy

```python
import os
from anthropic import Anthropic

# Initialize the client
client = Anthropic(
    api_key=os.getenv("ANTHROPIC_API_KEY")
)

# First request: Create a file with a random number
response1 = client.beta.messages.create(
    model="claude-sonnet-4-5",
    betas=["code-execution-2025-08-25"],
    max_tokens=4096,
    messages=[{
        "role": "user",
        "content": "Write a file with a random number and save it to '/tmp/number.txt'"
    }],
    tools=[{
        "type": "code_execution_20250825",
        "name": "code_execution"
    }]
)

# Extract the container ID from the first response
container_id = response1.container.id

# Second request: Reuse the container to read the file
response2 = client.beta.messages.create(
    container=container_id,  # Reuse the same container
    model="claude-sonnet-4-5",
    betas=["code-execution-2025-08-25"],
    max_tokens=4096,
    messages=[{
        "role": "user",
        "content": "Read the number from '/tmp/number.txt' and calculate its square"
    }],
    tools=[{
        "type": "code_execution_20250825",
        "name": "code_execution"
    }]
)
```

## 

[​

](#streaming)

Streaming

With streaming enabled, you’ll receive code execution events as they occur:

Copy

```javascript
event: content_block_start
data: {"type": "content_block_start", "index": 1, "content_block": {"type": "server_tool_use", "id": "srvtoolu_xyz789", "name": "code_execution"}}

// Code execution streamed
event: content_block_delta
data: {"type": "content_block_delta", "index": 1, "delta": {"type": "input_json_delta", "partial_json": "{\"code\":\"import pandas as pd\\ndf = pd.read_csv('data.csv')\\nprint(df.head())\"}"}}

// Pause while code executes

// Execution results streamed
event: content_block_start
data: {"type": "content_block_start", "index": 2, "content_block": {"type": "code_execution_tool_result", "tool_use_id": "srvtoolu_xyz789", "content": {"stdout": "   A  B  C\n0  1  2  3\n1  4  5  6", "stderr": ""}}}
```

## 

[​

](#batch-requests)

Batch requests

You can include the code execution tool in the [Messages Batches API](../../build-with-claude/batch-processing.html). Code execution tool calls through the Messages Batches API are priced the same as those in regular Messages API requests.

## 

[​

](#usage-and-pricing)

Usage and pricing

The code execution tool usage is tracked separately from token usage. Execution time is a minimum of 5 minutes. If files are included in the request, execution time is billed even if the tool is not used due to files being preloaded onto the container. **Pricing**: $0.05 per session-hour.

## 

[​

](#upgrade-to-latest-tool-version)

Upgrade to latest tool version

By upgrading to `code-execution-2025-08-25`, you get access to file manipulation and Bash capabilities, including code in multiple languages. There is no price difference.

### 

[​

](#what%E2%80%99s-changed)

What’s changed

| Component | Legacy | Current |
| --- | --- | --- |
| Beta header | `code-execution-2025-05-22` | `code-execution-2025-08-25` |
| Tool type | `code_execution_20250522` | `code_execution_20250825` |
| Capabilities | Python only | Bash commands, file operations |
| Response types | `code_execution_result` | `bash_code_execution_result`, `text_editor_code_execution_result` |

### 

[​

](#backward-compatibility)

Backward compatibility

-   All existing Python code execution continues to work exactly as before
-   No changes required to existing Python-only workflows

### 

[​

](#upgrade-steps)

Upgrade steps

To upgrade, you need to make the following changes in your API requests:

1.  **Update the beta header**:
    
    Copy
    
    ```diff
    - "anthropic-beta": "code-execution-2025-05-22"
    + "anthropic-beta": "code-execution-2025-08-25"
    ```
    
2.  **Update the tool type**:
    
    Copy
    
    ```diff
    - "type": "code_execution_20250522"
    + "type": "code_execution_20250825"
    ```
    
3.  **Review response handling** (if parsing responses programmatically):
    -   The previous blocks for Python execution responses will no longer be sent
    -   Instead, new response types for Bash and file operations will be sent (see Response Format section)

## 

[​

](#using-code-execution-with-agent-skills)

Using code execution with Agent Skills

The code execution tool enables Claude to use [Agent Skills](../agent-skills/overview.html). Skills are modular capabilities consisting of instructions, scripts, and resources that extend Claude’s functionality. Learn more in the [Agent Skills documentation](../agent-skills/overview.html) and [Agent Skills API guide](../agent-skills/api.html).

Was this page helpful?

YesNo

[Bash tool](bash-tool.html)[Computer use tool](computer-use-tool.html)

Assistant

Responses are generated using AI and may contain mistakes.

[Claude Docs home page![light logo](../../../../../mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/light%EF%B9%96fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=c877c45432515ee69194cb19e9f983a2.svg)![dark logo](../../../../../mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/dark%EF%B9%96fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=f5bb877be0cb3cba86cf6d7c88185216.svg)](../../../home.html)

[x](https://x.com/AnthropicAI)[linkedin](https://www.linkedin.com/company/anthropicresearch)

Company

[Anthropic](https://www.anthropic.com/company)[Careers](https://www.anthropic.com/careers)[Economic Futures](https://www.anthropic.com/economic-futures)[Research](https://www.anthropic.com/research)[News](https://www.anthropic.com/news)[Trust center](https://trust.anthropic.com/)[Transparency](https://www.anthropic.com/transparency)

Help and security

[Availability](https://www.anthropic.com/supported-countries)[Status](https://status.anthropic.com/)[Support center](https://support.claude.com/)

Learn

[Courses](https://www.anthropic.com/learn)[MCP connectors](https://claude.com/partners/mcp)[Customer stories](https://www.claude.com/customers)[Engineering blog](https://www.anthropic.com/engineering)[Events](https://www.anthropic.com/events)[Powered by Claude](https://claude.com/partners/powered-by-claude)[Service partners](https://claude.com/partners/services)[Startups program](https://claude.com/programs/startups)

Terms and policies

[Privacy policy](https://www.anthropic.com/legal/privacy)[Disclosure policy](https://www.anthropic.com/responsible-disclosure-policy)[Usage policy](https://www.anthropic.com/legal/aup)[Commercial terms](https://www.anthropic.com/legal/commercial-terms)[Consumer terms](https://www.anthropic.com/legal/consumer-terms)