Bash tool - Claude Docs 

[Claude Docs home page![light logo](../../../../../mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/light%EF%B9%96fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=c877c45432515ee69194cb19e9f983a2.svg)![dark logo](../../../../../mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/dark%EF%B9%96fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=f5bb877be0cb3cba86cf6d7c88185216.svg)](../../../home.html)

![US](../../../../../d3gk2c5xim1je2.cloudfront.net/flags/US.svg)

English

Search...

⌘K

-   [Console](https://console.anthropic.com/login)
-   [Support](https://support.claude.com/)
-   [Discord](https://www.anthropic.com/discord)
-   [Sign up](https://console.anthropic.com/login)
-   [
    
    Sign up
    
    ](https://console.anthropic.com/login)

Search...

Navigation

Tools

Bash tool

[Welcome

](../../../home.html)[Claude Developer Platform

](../../intro.html)[Claude Code

](../../claude-code/overview.html)[Model Context Protocol (MCP)

](../../mcp.html)[API Reference

](../../../api/messages.html)[Resources

](../../../resources/overview.html)[Release Notes

](../../../release-notes/overview.html)

-   [
    
    Developer Guide](../../intro.html)
-   [
    
    API Guide](../../../api/overview.html)

##### First steps

-   [
    
    Intro to Claude
    
    
    
    ](../../intro.html)
-   [
    
    Quick start
    
    
    
    ](../../get-started.html)

##### Models & pricing

-   [
    
    Models overview
    
    
    
    ](../../about-claude/models/overview.html)
-   [
    
    Choosing a model
    
    
    
    ](../../about-claude/models/choosing-a-model.html)
-   [
    
    What's new in Claude 4.5
    
    
    
    ](../../about-claude/models/whats-new-claude-4-5.html)
-   [
    
    Migrating to Claude 4.5
    
    
    
    ](../../about-claude/models/migrating-to-claude-4.html)
-   [
    
    Model deprecations
    
    
    
    ](../../about-claude/model-deprecations.html)
-   [
    
    Pricing
    
    
    
    ](../../about-claude/pricing.html)

##### Learn about Claude

-   [
    
    Features overview
    
    
    
    ](../../build-with-claude/overview.html)
-   [
    
    Building with Claude
    
    
    
    ](../../overview.html)
-   [
    
    Context windows
    
    
    
    ](../../build-with-claude/context-windows.html)
-   [
    
    Glossary
    
    
    
    ](../../about-claude/glossary.html)

##### Capabilities

-   [
    
    Prompt caching
    
    
    
    ](../../build-with-claude/prompt-caching.html)
-   [
    
    Context editing
    
    
    
    ](../../build-with-claude/context-editing.html)
-   [
    
    Extended thinking
    
    
    
    ](../../build-with-claude/extended-thinking.html)
-   [
    
    Streaming Messages
    
    
    
    ](../../build-with-claude/streaming.html)
-   [
    
    Batch processing
    
    
    
    ](../../build-with-claude/batch-processing.html)
-   [
    
    Citations
    
    
    
    ](../../build-with-claude/citations.html)
-   [
    
    Multilingual support
    
    
    
    ](../../build-with-claude/multilingual-support.html)
-   [
    
    Token counting
    
    
    
    ](../../build-with-claude/token-counting.html)
-   [
    
    Embeddings
    
    
    
    ](../../build-with-claude/embeddings.html)
-   [
    
    Vision
    
    
    
    ](../../build-with-claude/vision.html)
-   [
    
    PDF support
    
    
    
    ](../../build-with-claude/pdf-support.html)
-   [
    
    Files API
    
    
    
    ](../../build-with-claude/files.html)
-   [
    
    Search results
    
    
    
    ](../../build-with-claude/search-results.html)
-   [
    
    Google Sheets add-on
    
    
    
    ](../claude-for-sheets.html)

##### Tools

-   [
    
    Overview
    
    
    
    ](overview.html)
-   [
    
    How to implement tool use
    
    
    
    ](implement-tool-use.html)
-   [
    
    Token-efficient tool use
    
    
    
    ](token-efficient-tool-use.html)
-   [
    
    Fine-grained tool streaming
    
    
    
    ](fine-grained-tool-streaming.html)
-   [
    
    Bash tool
    
    
    
    ](bash-tool.html)
-   [
    
    Code execution tool
    
    
    
    ](code-execution-tool.html)
-   [
    
    Computer use tool
    
    
    
    ](computer-use-tool.html)
-   [
    
    Text editor tool
    
    
    
    ](text-editor-tool.html)
-   [
    
    Web fetch tool
    
    
    
    ](web-fetch-tool.html)
-   [
    
    Web search tool
    
    
    
    ](web-search-tool.html)
-   [
    
    Memory tool
    
    
    
    ](memory-tool.html)

##### Agent Skills

-   [
    
    Overview
    
    
    
    ](../agent-skills/overview.html)
-   [
    
    Quickstart
    
    
    
    ](../agent-skills/quickstart.html)
-   [
    
    Best practices
    
    
    
    ](../agent-skills/best-practices.html)

##### Model Context Protocol (MCP)

-   [
    
    MCP connector
    
    
    
    ](../mcp-connector.html)
-   [
    
    Remote MCP servers
    
    
    
    ](../remote-mcp-servers.html)

##### Use cases

-   [
    
    Overview
    
    
    
    ](../../about-claude/use-case-guides/overview.html)
-   [
    
    Ticket routing
    
    
    
    ](../../about-claude/use-case-guides/ticket-routing.html)
-   [
    
    Customer support agent
    
    
    
    ](../../about-claude/use-case-guides/customer-support-chat.html)
-   [
    
    Content moderation
    
    
    
    ](../../about-claude/use-case-guides/content-moderation.html)
-   [
    
    Legal summarization
    
    
    
    ](../../about-claude/use-case-guides/legal-summarization.html)

##### Prompt engineering

-   [
    
    Overview
    
    
    
    ](../../build-with-claude/prompt-engineering/overview.html)
-   [
    
    Claude 4 best practices
    
    
    
    ](../../build-with-claude/prompt-engineering/claude-4-best-practices.html)
-   [
    
    Prompt generator
    
    
    
    ](../../build-with-claude/prompt-engineering/prompt-generator.html)
-   [
    
    Use prompt templates
    
    
    
    ](../../build-with-claude/prompt-engineering/prompt-templates-and-variables.html)
-   [
    
    Prompt improver
    
    
    
    ](../../build-with-claude/prompt-engineering/prompt-improver.html)
-   [
    
    Be clear and direct
    
    
    
    ](../../build-with-claude/prompt-engineering/be-clear-and-direct.html)
-   [
    
    Use examples (multishot prompting)
    
    
    
    ](../../build-with-claude/prompt-engineering/multishot-prompting.html)
-   [
    
    Let Claude think (CoT)
    
    
    
    ](../../build-with-claude/prompt-engineering/chain-of-thought.html)
-   [
    
    Use XML tags
    
    
    
    ](../../build-with-claude/prompt-engineering/use-xml-tags.html)
-   [
    
    Give Claude a role (system prompts)
    
    
    
    ](../../build-with-claude/prompt-engineering/system-prompts.html)
-   [
    
    Prefill Claude's response
    
    
    
    ](../../build-with-claude/prompt-engineering/prefill-claudes-response.html)
-   [
    
    Chain complex prompts
    
    
    
    ](../../build-with-claude/prompt-engineering/chain-prompts.html)
-   [
    
    Long context tips
    
    
    
    ](../../build-with-claude/prompt-engineering/long-context-tips.html)
-   [
    
    Extended thinking tips
    
    
    
    ](../../build-with-claude/prompt-engineering/extended-thinking-tips.html)

##### Test & evaluate

-   [
    
    Define success criteria
    
    
    
    ](../../test-and-evaluate/define-success.html)
-   [
    
    Develop test cases
    
    
    
    ](../../test-and-evaluate/develop-tests.html)
-   [
    
    Using the Evaluation Tool
    
    
    
    ](../../test-and-evaluate/eval-tool.html)
-   [
    
    Reducing latency
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/reduce-latency.html)

##### Strengthen guardrails

-   [
    
    Reduce hallucinations
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/reduce-hallucinations.html)
-   [
    
    Increase output consistency
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/increase-consistency.html)
-   [
    
    Mitigate jailbreaks
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/mitigate-jailbreaks.html)
-   [
    
    Streaming refusals
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/handle-streaming-refusals.html)
-   [
    
    Reduce prompt leak
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/reduce-prompt-leak.html)
-   [
    
    Keep Claude in character
    
    
    
    ](../../test-and-evaluate/strengthen-guardrails/keep-claude-in-character.html)

 

On this page

-   [Overview](#overview)
-   [Model compatibility](#model-compatibility)
-   [Use cases](#use-cases)
-   [Quick start](#quick-start)
-   [How it works](#how-it-works)
-   [Parameters](#parameters)
-   [Example: Multi-step automation](#example%3A-multi-step-automation)
-   [Implement the bash tool](#implement-the-bash-tool)
-   [Handle errors](#handle-errors)
-   [Follow implementation best practices](#follow-implementation-best-practices)
-   [Security](#security)
-   [Key recommendations](#key-recommendations)
-   [Pricing](#pricing)
-   [Common patterns](#common-patterns)
-   [Development workflows](#development-workflows)
-   [File operations](#file-operations)
-   [System tasks](#system-tasks)
-   [Limitations](#limitations)
-   [Combining with other tools](#combining-with-other-tools)
-   [Next steps](#next-steps)

Tools

# Bash tool

Copy page

Copy page

The bash tool enables Claude to execute shell commands in a persistent bash session, allowing system operations, script execution, and command-line automation.

## 

[​

](#overview)

Overview

The bash tool provides Claude with:

-   Persistent bash session that maintains state
-   Ability to run any shell command
-   Access to environment variables and working directory
-   Command chaining and scripting capabilities

## 

[​

](#model-compatibility)

Model compatibility

| Model | Tool Version |
| --- | --- |
| Claude 4 models and Sonnet 3.7 | `bash_20250124` |
| Claude Sonnet 3.5 ([deprecated](../../about-claude/model-deprecations.html)) | `bash_20241022` |

Claude Sonnet 3.5 ([deprecated](../../about-claude/model-deprecations.html)) requires the `computer-use-2024-10-22` beta header when using the bash tool.The bash tool is generally available in Claude 4 models and Sonnet 3.7.

Older tool versions are not guaranteed to be backwards-compatible with newer models. Always use the tool version that corresponds to your model version.

## 

[​

](#use-cases)

Use cases

-   **Development workflows**: Run build commands, tests, and development tools
-   **System automation**: Execute scripts, manage files, automate tasks
-   **Data processing**: Process files, run analysis scripts, manage datasets
-   **Environment setup**: Install packages, configure environments

## 

[​

](#quick-start)

Quick start

Python

Shell

Copy

```python
import anthropic

client = anthropic.Anthropic()

response = client.messages.create(
    model="claude-sonnet-4-5",
    max_tokens=1024,
    tools=[
        {
            "type": "bash_20250124",
            "name": "bash"
        }
    ],
    messages=[
        {"role": "user", "content": "List all Python files in the current directory."}
    ]
)
```

## 

[​

](#how-it-works)

How it works

The bash tool maintains a persistent session:

1.  Claude determines what command to run
2.  You execute the command in a bash shell
3.  Return the output (stdout and stderr) to Claude
4.  Session state persists between commands (environment variables, working directory)

## 

[​

](#parameters)

Parameters

| Parameter | Required | Description |
| --- | --- | --- |
| `command` | Yes\* | The bash command to run |
| `restart` | No | Set to `true` to restart the bash session |

\*Required unless using `restart`Example usage

Copy

```json
// Run a command
{
  "command": "ls -la *.py"
}

// Restart the session
{
  "restart": true
}
```

## 

[​

](#example%3A-multi-step-automation)

Example: Multi-step automation

Claude can chain commands to complete complex tasks:

Copy

```python
# User request
"Install the requests library and create a simple Python script that fetches a joke from an API, then run it."

# Claude's tool uses:
# 1. Install package
{"command": "pip install requests"}

# 2. Create script
{"command": "cat > fetch_joke.py << 'EOF'\nimport requests\nresponse = requests.get('https://official-joke-api.appspot.com/random_joke')\njoke = response.json()\nprint(f\"Setup: {joke['setup']}\")\nprint(f\"Punchline: {joke['punchline']}\")\nEOF"}

# 3. Run script
{"command": "python fetch_joke.py"}
```

The session maintains state between commands, so files created in step 2 are available in step 3.

* * *

## 

[​

](#implement-the-bash-tool)

Implement the bash tool

The bash tool is implemented as a schema-less tool. When using this tool, you don’t need to provide an input schema as with other tools; the schema is built into Claude’s model and can’t be modified.

1

Set up a bash environment

Create a persistent bash session that Claude can interact with:

Copy

```python
import subprocess
import threading
import queue

class BashSession:
    def __init__(self):
        self.process = subprocess.Popen(
            ['/bin/bash'],
            stdin=subprocess.PIPE,
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE,
            text=True,
            bufsize=0
        )
        self.output_queue = queue.Queue()
        self.error_queue = queue.Queue()
        self._start_readers()
```

2

Handle command execution

Create a function to execute commands and capture output:

Copy

```python
def execute_command(self, command):
    # Send command to bash
    self.process.stdin.write(command + '\n')
    self.process.stdin.flush()
    
    # Capture output with timeout
    output = self._read_output(timeout=10)
    return output
```

3

Process Claude's tool calls

Extract and execute commands from Claude’s responses:

Copy

```python
for content in response.content:
    if content.type == "tool_use" and content.name == "bash":
        if content.input.get("restart"):
            bash_session.restart()
            result = "Bash session restarted"
        else:
            command = content.input.get("command")
            result = bash_session.execute_command(command)
        
        # Return result to Claude
        tool_result = {
            "type": "tool_result",
            "tool_use_id": content.id,
            "content": result
        }
```

4

Implement safety measures

Add validation and restrictions:

Copy

```python
def validate_command(command):
    # Block dangerous commands
    dangerous_patterns = ['rm -rf /', 'format', ':(){:|:&};:']
    for pattern in dangerous_patterns:
        if pattern in command:
            return False, f"Command contains dangerous pattern: {pattern}"
    
    # Add more validation as needed
    return True, None
```

### 

[​

](#handle-errors)

Handle errors

When implementing the bash tool, handle various error scenarios:

Command execution timeout

If a command takes too long to execute:

Copy

```json
{
  "role": "user",
  "content": [
    {
      "type": "tool_result",
      "tool_use_id": "toolu_01A09q90qw90lq917835lq9",
      "content": "Error: Command timed out after 30 seconds",
      "is_error": true
    }
  ]
}
```
Command not found

If a command doesn’t exist:

Copy

```json
{
  "role": "user",
  "content": [
    {
      "type": "tool_result",
      "tool_use_id": "toolu_01A09q90qw90lq917835lq9",
      "content": "bash: nonexistentcommand: command not found",
      "is_error": true
    }
  ]
}
```
Permission denied

If there are permission issues:

Copy

```json
{
  "role": "user",
  "content": [
    {
      "type": "tool_result",
      "tool_use_id": "toolu_01A09q90qw90lq917835lq9",
      "content": "bash: /root/sensitive-file: Permission denied",
      "is_error": true
    }
  ]
}
```

### 

[​

](#follow-implementation-best-practices)

Follow implementation best practices

Use command timeouts

Implement timeouts to prevent hanging commands:

Copy

```python
def execute_with_timeout(command, timeout=30):
    try:
        result = subprocess.run(
            command, 
            shell=True, 
            capture_output=True, 
            text=True, 
            timeout=timeout
        )
        return result.stdout + result.stderr
    except subprocess.TimeoutExpired:
        return f"Command timed out after {timeout} seconds"
```
Maintain session state

Keep the bash session persistent to maintain environment variables and working directory:

Copy

```python
# Commands run in the same session maintain state
commands = [
    "cd /tmp",
    "echo 'Hello' > test.txt",
    "cat test.txt"  # This works because we're still in /tmp
]
```
Handle large outputs

Truncate very large outputs to prevent token limit issues:

Copy

```python
def truncate_output(output, max_lines=100):
    lines = output.split('\n')
    if len(lines) > max_lines:
        truncated = '\n'.join(lines[:max_lines])
        return f"{truncated}\n\n... Output truncated ({len(lines)} total lines) ..."
    return output
```
Log all commands

Keep an audit trail of executed commands:

Copy

```python
import logging

def log_command(command, output, user_id):
    logging.info(f"User {user_id} executed: {command}")
    logging.info(f"Output: {output[:200]}...")  # Log first 200 chars
```
Sanitize outputs

Remove sensitive information from command outputs:

Copy

```python
def sanitize_output(output):
    # Remove potential secrets or credentials
    import re
    # Example: Remove AWS credentials
    output = re.sub(r'aws_access_key_id\s*=\s*\S+', 'aws_access_key_id=***', output)
    output = re.sub(r'aws_secret_access_key\s*=\s*\S+', 'aws_secret_access_key=***', output)
    return output
```

## 

[​

](#security)

Security

The bash tool provides direct system access. Implement these essential safety measures:

-   Running in isolated environments (Docker/VM)
-   Implementing command filtering and allowlists
-   Setting resource limits (CPU, memory, disk)
-   Logging all executed commands

### 

[​

](#key-recommendations)

Key recommendations

-   Use `ulimit` to set resource constraints
-   Filter dangerous commands (`sudo`, `rm -rf`, etc.)
-   Run with minimal user permissions
-   Monitor and log all command execution

## 

[​

](#pricing)

Pricing

The bash tool adds **245 input tokens** to your API calls. Additional tokens are consumed by:

-   Command outputs (stdout/stderr)
-   Error messages
-   Large file contents

See [tool use pricing](overview.html#pricing) for complete pricing details.

## 

[​

](#common-patterns)

Common patterns

### 

[​

](#development-workflows)

Development workflows

-   Running tests: `pytest && coverage report`
-   Building projects: `npm install && npm run build`
-   Git operations: `git status && git add . && git commit -m "message"`

### 

[​

](#file-operations)

File operations

-   Processing data: `wc -l *.csv && ls -lh *.csv`
-   Searching files: `find . -name "*.py" | xargs grep "pattern"`
-   Creating backups: `tar -czf backup.tar.gz ./data`

### 

[​

](#system-tasks)

System tasks

-   Checking resources: `df -h && free -m`
-   Process management: `ps aux | grep python`
-   Environment setup: `export PATH=$PATH:/new/path && echo $PATH`

## 

[​

](#limitations)

Limitations

-   **No interactive commands**: Cannot handle `vim`, `less`, or password prompts
-   **No GUI applications**: Command-line only
-   **Session scope**: Persists within conversation, lost between API calls
-   **Output limits**: Large outputs may be truncated
-   **No streaming**: Results returned after completion

## 

[​

](#combining-with-other-tools)

Combining with other tools

The bash tool is most powerful when combined with the [text editor](text-editor-tool.html) and other tools.

## 

[​

](#next-steps)

Next steps

[

## Tool use overview

Learn about tool use with Claude





](overview.html)[

## Text editor tool

View and edit text files with Claude





](text-editor-tool.html)

Was this page helpful?

YesNo

[Fine-grained tool streaming](fine-grained-tool-streaming.html)[Code execution tool](code-execution-tool.html)

Assistant

Responses are generated using AI and may contain mistakes.

[Claude Docs home page![light logo](../../../../../mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/light%EF%B9%96fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=c877c45432515ee69194cb19e9f983a2.svg)![dark logo](../../../../../mintcdn.com/anthropic-claude-docs/DcI2Ybid7ZEnFaf0/logo/dark%EF%B9%96fit=max&auto=format&n=DcI2Ybid7ZEnFaf0&q=85&s=f5bb877be0cb3cba86cf6d7c88185216.svg)](../../../home.html)

[x](https://x.com/AnthropicAI)[linkedin](https://www.linkedin.com/company/anthropicresearch)

Company

[Anthropic](https://www.anthropic.com/company)[Careers](https://www.anthropic.com/careers)[Economic Futures](https://www.anthropic.com/economic-futures)[Research](https://www.anthropic.com/research)[News](https://www.anthropic.com/news)[Trust center](https://trust.anthropic.com/)[Transparency](https://www.anthropic.com/transparency)

Help and security

[Availability](https://www.anthropic.com/supported-countries)[Status](https://status.anthropic.com/)[Support center](https://support.claude.com/)

Learn

[Courses](https://www.anthropic.com/learn)[MCP connectors](https://claude.com/partners/mcp)[Customer stories](https://www.claude.com/customers)[Engineering blog](https://www.anthropic.com/engineering)[Events](https://www.anthropic.com/events)[Powered by Claude](https://claude.com/partners/powered-by-claude)[Service partners](https://claude.com/partners/services)[Startups program](https://claude.com/programs/startups)

Terms and policies

[Privacy policy](https://www.anthropic.com/legal/privacy)[Disclosure policy](https://www.anthropic.com/responsible-disclosure-policy)[Usage policy](https://www.anthropic.com/legal/aup)[Commercial terms](https://www.anthropic.com/legal/commercial-terms)[Consumer terms](https://www.anthropic.com/legal/consumer-terms)