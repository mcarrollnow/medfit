AI SDK 5 is available now.










Menu










































































































































































































































































































































































































# [Saving and Restoring States](#saving-and-restoring-states)




AI SDK RSC is currently experimental. We recommend using [AI SDK UI](../ai-sdk-ui/overview.html) for production. For guidance on migrating from RSC to UI, see our [migration guide](migrating-to-ui.html).



AI SDK RSC provides convenient methods for saving and restoring AI and UI state. This is useful for saving the state of your application after every model generation, and restoring it when the user revisits the generations.

## [AI State](#ai-state)

### [Saving AI state](#saving-ai-state)

The AI state can be saved using the [`onSetAIState`](../reference/ai-sdk-rsc/create-ai.html#on-set-ai-state) callback, which gets called whenever the AI state is updated. In the following example, you save the chat history to a database whenever the generation is marked as done.












``` tsx
export const AI = createAI<ServerMessage[], ClientMessage[]>(,  onSetAIState: async () =>   },});
```


### [Restoring AI state](#restoring-ai-state)

The AI state can be restored using the [`initialAIState`](../reference/ai-sdk-rsc/create-ai.html#initial-ai-state) prop passed to the context provider created by the [`createAI`](../reference/ai-sdk-rsc/create-ai.html) function. In the following example, you restore the chat history from a database when the component is mounted.



``` tsx
import  from 'react';import  from './ai';
export default async function RootLayout(: Readonly<>) ></AI>      </body>    </html>  );}
```


## [UI State](#ui-state)

### [Saving UI state](#saving-ui-state)

The UI state cannot be saved directly, since the contents aren't yet serializable. Instead, you can use the AI state as proxy to store details about the UI state and use it to restore the UI state when needed.

### [Restoring UI state](#restoring-ui-state)

The UI state can be restored using the AI state as a proxy. In the following example, you restore the chat history from the AI state when the component is mounted. You use the [`onGetUIState`](../reference/ai-sdk-rsc/create-ai.html#on-get-ui-state) callback to listen for SSR events and restore the UI state.












``` tsx
export const AI = createAI<ServerMessage[], ClientMessage[]>(,  onGetUIState: async () => ) => ( />          ) : (            content          ),      }));    }  },});
```


To learn more, check out this [example](../../cookbook/rsc/save-messages-to-database.html) that persists and restores states in your Next.js application.

------------------------------------------------------------------------

Next, you will learn how you can use `@ai-sdk/rsc` functions like `useActions` and `useUIState` to create interactive, multistep interfaces.
















On this page



































Vercel delivers the infrastructure and developer experience you need to ship reliable AI-powered applications at scale.

Trusted by industry leaders:















#### Resources




#### More




#### About Vercel




#### Legal







Â© 2025 Vercel, Inc.