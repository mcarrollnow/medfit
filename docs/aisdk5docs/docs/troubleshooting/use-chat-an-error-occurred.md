AI SDK 5 is available now.










Menu




































































































































































































































































































































































































































































































# [`useChat` "An error occurred"](#usechat-an-error-occurred)

## [Issue](#issue)

I am using [`useChat`](../reference/ai-sdk-ui/use-chat.html) and I get the error "An error occurred".

## [Background](#background)

Error messages from `streamText` are masked by default when using `toDataStreamResponse` for security reasons (secure-by-default). This prevents leaking sensitive information to the client.

## [Solution](#solution)

To forward error details to the client or to log errors, use the `getErrorMessage` function when calling `toDataStreamResponse`.



``` tsx
export function errorHandler(error: unknown) 
  if (typeof error === 'string') 
  if (error instanceof Error) 
  return JSON.stringify(error);}
```




``` tsx
const result = streamText();
return result.toUIMessageStreamResponse();
```


In case you are using `createDataStreamResponse`, you can use the `onError` function when calling `toDataStreamResponse`:



``` tsx
const response = createDataStreamResponse(,  onError: errorHandler,});
```

















On this page






















Vercel delivers the infrastructure and developer experience you need to ship reliable AI-powered applications at scale.

Trusted by industry leaders:















#### Resources




#### More




#### About Vercel




#### Legal







Â© 2025 Vercel, Inc.