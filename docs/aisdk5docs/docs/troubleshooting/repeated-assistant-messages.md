AI SDK 5 is available now.










Menu




































































































































































































































































































































































































































































































# [Repeated assistant messages in useChat](#repeated-assistant-messages-in-usechat)

## [Issue](#issue)

When using `useChat` with `streamText` on the server, the assistant's messages appear duplicated in the UI - showing both the previous message and the new message, or showing the same message multiple times. This can occur when using tool calls or complex message flows.



``` tsx
// Server-side code that may experience assistant message duplication on the clientexport async function POST(req: Request)  = await req.json();
  const result = streamText(),        execute: async () => ;        },      },    },  });
  return result.toUIMessageStreamResponse();}
```


## [Background](#background)

The duplication occurs because `toUIMessageStreamResponse` generates new message IDs for each new message.

## [Solution](#solution)

Pass the original messages array to `toUIMessageStreamResponse` using the `originalMessages` option. By passing `originalMessages`, the method can reuse existing message IDs instead of generating new ones, ensuring the client properly updates existing messages rather than creating duplicates.



``` tsx
export async function POST(req: Request)  = await req.json();
  const result = streamText(),        execute: async () => ;        },      },    },  });
  return result.toUIMessageStreamResponse() => );    },  });}
```

















On this page






















Vercel delivers the infrastructure and developer experience you need to ship reliable AI-powered applications at scale.

Trusted by industry leaders:















#### Resources




#### More




#### About Vercel




#### Legal







Â© 2025 Vercel, Inc.