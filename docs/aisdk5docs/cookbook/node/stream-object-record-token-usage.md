AI SDK 5 is available now.










Menu


























































































































































































































































































































































































# [Record Token Usage After Streaming Object](#record-token-usage-after-streaming-object)

When you're streaming structured data with [`streamObject`](../../docs/reference/ai-sdk-core/stream-object.html), you may want to record the token usage for billing purposes.

## [`onFinish` Callback](#onfinish-callback)

You can use the `onFinish` callback to record token usage. It is called when the stream is finished.



``` ts
import  from '@ai-sdk/openai';import  from 'ai';import  from 'zod';
const result = streamObject(),  }),  prompt: 'Generate a lasagna recipe.',  onFinish() ,});
```


## [`usage` Promise](#usage-promise)

The [`streamObject`](../../docs/reference/ai-sdk-core/stream-object.html) result contains a `usage` promise that resolves to the total token usage.



``` ts
import  from '@ai-sdk/openai';import  from 'ai';import  from 'zod';
const result = streamObject(),  }),  prompt: 'Generate a lasagna recipe.',});
// your custom function to record token usage:function recordTokenUsage(: TokenUsage) 
// use as promise:result.usage.then(recordTokenUsage);
// use with async/await:recordTokenUsage(await result.usage);
// note: the stream needs to be consumed because of backpressurefor await (const partialObject of result.partialObjectStream) 
```

















On this page



















Vercel delivers the infrastructure and developer experience you need to ship reliable AI-powered applications at scale.

Trusted by industry leaders:















#### Resources




#### More




#### About Vercel




#### Legal







Â© 2025 Vercel, Inc.