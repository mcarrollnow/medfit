AI SDK 5 is available now.










Menu


























































































































































































































































































































































































# [streamText Multi-Step Agent](#streamtext-multi-step-agent)

You may want to have different steps in your stream where each step has different settings, e.g. models, tools, or system prompts.

With `createUIMessageStream` and `sendFinish` / `sendStart` options when merging into the `UIMessageStream`, you can control when the finish and start events are sent to the client, allowing you to have different steps in a single assistant UI message.

## [Server](#server)












``` typescript
import  from '@ai-sdk/openai';import  from 'ai';import  from 'zod';
export async function POST(req: Request)  = await req.json();
  const stream = createUIMessageStream() => ),            execute: async () => goal, // no-op extract tool          }),        },      });
      // forward the initial result to the client without the finish event:      writer.merge(result1.toUIMessageStream());
      // note: you can use any programming construct here, e.g. if-else, loops, etc.      // workflow programming is normal programming with this approach.
      // example: continue stream with forced tool call from previous step      const result2 = streamText();
      // forward the 2nd result to the client (incl. the finish event):      writer.merge(result2.toUIMessageStream());    },  });
  return createUIMessageStreamResponse();}
```


## [Client](#client)












``` tsx
'use client';
import  from '@ai-sdk/react';import  from 'react';
export default function Chat()  = useChat();
  return (    <div>      >          <strong>: `}</strong>          ></span>;              case 'tool-extractGoal': ></pre>;              }            }          })}        </div>      ))}      <form        onSubmit=);          setInput('');        }}      >        <input value= onChange= />      </form>    </div>  );}
```

















On this page



















Vercel delivers the infrastructure and developer experience you need to ship reliable AI-powered applications at scale.

Trusted by industry leaders:















#### Resources




#### More




#### About Vercel




#### Legal







Â© 2025 Vercel, Inc.