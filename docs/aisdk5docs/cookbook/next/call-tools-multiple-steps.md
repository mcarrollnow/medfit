AI SDK 5 is available now.










Menu


























































































































































































































































































































































































# [Call Tools in Multiple Steps](#call-tools-in-multiple-steps)

Some language models are great at calling tools in multiple steps to achieve a more complex task. This is particularly useful when the tools are dependent on each other and need to be executed in sequence during the same generation step.

## [Client](#client)

Let's create a React component that imports the `useChat` hook from the `@ai-sdk/react` module. The `useChat` hook will call the `/api/chat` endpoint when the user sends a message. The endpoint will generate the assistant's response based on the conversation history and stream it to the client. If the assistant responds with a tool call, the hook will automatically display them as well.












``` tsx
'use client';
import  from '@ai-sdk/react';import  from 'ai';import  from 'react';import type  from './api/chat/route';
export default function Page()  = useChat<ChatMessage>(),  });
  return (    <div>      <input        className="border"        value=        onChange=}        onKeyDown=);            setInput('');          }        }}      />
      >          -text`}></div>;              case 'tool-getLocation':              case 'tool-getWeather':                return (                  <div key=-weather-$`}>                                      </div>                );            }          })}        </div>      ))}    </div>  );}
```


## [Server](#server)

You will create a new route at `/api/chat` that will use the `streamText` function from the `ai` module to generate the assistant's response based on the conversation history.

You will use the [`tools`](../../docs/reference/ai-sdk-core/generate-text.html#tools) parameter to specify two tools called `getLocation` and `getWeather` that will first get the user's location and then use it to get the weather.

You will add the two functions mentioned earlier and use zod to specify the schema for its parameters.

To call tools in multiple steps, you can use the `stopWhen` option to specify the stopping conditions for when the model generates a tool call. In this example, you will set it to `stepCountIs(5)` to allow for multiple consecutive tool calls (steps).












``` ts
import  from '@ai-sdk/openai';import  from 'ai';import  from 'zod';
const tools = ),    execute: async () => ;      return `Your location is at latitude $ and longitude $`;    },  }),  getWeather: tool(),    execute: async () => ;
      return `It is currently $°$ and $ in $!`;    },  }),} satisfies ToolSet;
export type ChatTools = InferUITools<typeof tools>;
export type ChatMessage = UIMessage<never, UIDataTypes, ChatTools>;
export async function POST(req: Request) :  = await req.json();
  const result = streamText();
  return result.toUIMessageStreamResponse();}
```

















On this page



















Vercel delivers the infrastructure and developer experience you need to ship reliable AI-powered applications at scale.

Trusted by industry leaders:















#### Resources




#### More




#### About Vercel




#### Legal







© 2025 Vercel, Inc.